.MODEL SMALL

.STACK 100H

.DATA

OUTMSG DB '...', 0AH, '$'
EXTRA DB '->', '$'
WAVE_SIZE DW 30
	
FILE_NAME DB 'C:\GARDEN\TEST.TXT', 0
FILE_HANDLE DW 0
FILE_BUFFER DB 255 DUP (?)
	
.CODE

JMP START

DELAY_PROC PROC NEAR
	PUSH AX
	PUSH CX
	PUSH DX
	MOV CX, 1
	MOV DX, 0H
	MOV AH, 86H
	INT 15H
	POP DX
	POP CX
	POP AX
	RET
ENDP

FILE_READ_PROC PROC NEAR
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX

	MOV AH, 3DH
	MOV AL, 0
	MOV DX, OFFSET FILE_NAME
	INT 21H
	MOV FILE_HANDLE, AX

	
	MOV AH, 3FH
	MOV CX, 4
	MOV DX, OFFSET FILE_BUFFER
	MOV BX, FILE_HANDLE
	INT 21H

	MOV BX, FILE_HANDLE	
	MOV AH,3EH
	INT 21H 

	MOV DX, OFFSET FILE_BUFFER
	ADD DX, AX
	MOV BX ,DX
	MOV BYTE [BX], '$'

	MOV DX, OFFSET FILE_BUFFER
	MOV AH, 9
	INT 21H
	
	POP DX
	POP CX
	POP BX
	POP AX
	RET
ENDP

DRAW_WAVE PROC NEAR	
	PUSH AX
	PUSH BX
	MOV ES, CX
	MOV BX, 0
	PUSH CX
	PUSH DX
XLOOP:
	MOV AX,0
	MOV CX, ES
YLOOP:
	PUSH AX
	MOV AH, 0CH
	MOV AL, AL
	INT 10H
	POP AX

	INC CX
	INC AX
	CMP AX, 30
	JNE YLOOP
	
	INC DX
	INC BX
	CMP BX, 30
	JNE XLOOP

	CALL DELAY_PROC
	POP DX
	POP CX
	POP BX
	POP AX
	RET
ENDP

START:
	;; MOV AX, 13H
;; 	MOV AH, 0
;; 	INT 10H
	
;; 	MOV AX, @DATA 
;; 	MOV DS, AX 
;; 	MOV DX, OFFSET EXTRA	
;; 	MOV AH, 9

;; 	MOV CX, 200		
;; 	MOV DX, 200
	
;; EXECUTION:
;; 	MOV DX, CX
;; 	CALL DRAW_WAVE
;; 	SUB CX, 4
;; 	CMP CX, 0
;; 	JNE EXECUTION
	
	CALL FILE_READ_PROC
	
	MOV AL, 0 		
	MOV AH, 4CH
	INT 21H
END START

















